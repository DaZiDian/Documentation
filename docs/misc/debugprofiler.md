# 调试性能分析器

Minecraft 提供了一个调试性能分析器，它提供系统数据、当前游戏设置、JVM 数据、级别数据和边界刻信息，以找到耗时的代码。考虑到诸如 `TickEvent` 和刻动 `BlockEntities` 等因素，这对于想要找到卡顿来源的模组开发者和服务器所有者非常有用。

## 使用调试性能分析器

调试性能分析器非常简单易用。它需要使用调试按键组合 `F3 + L` 来启动分析器。10 秒后，它将自动停止；但是，您也可以通过再次按下该组合键来提前停止。

:::note
自然而然，您只能分析实际被执行的代码路径。您想要分析的 `实体` 和 `BlockEntities` 必须存在于级别中才会出现在结果中。
:::

在停止调试器后，它将在运行目录的 `debug/profiling` 子目录中创建一个新的 zip 文件。文件名将以日期和时间格式化为 `yyyy-mm-dd_hh_mi_ss-WorldName-VersionNumber.zip`

## 阅读性能分析结果

在每个边界文件夹 (`client` 和 `server`) 中，您会找到一个包含结果数据的 `profiling.txt` 文件。在顶部，它首先告诉您在运行的毫秒数以及在此期间运行了多少个刻。

在此之下，您会发现类似于以下片段的信息：
```
[00] levels - 96.70%/96.70%
[01] |   Level Name - 99.76%/96.47%
[02] |   |   tick - 99.31%/95.81%
[03] |   |   |   entities - 47.72%/45.72%
[04] |   |   |   |   regular - 98.32%/44.95%
[04] |   |   |   |   blockEntities - 0.90%/0.41%
[05] |   |   |   |   |   unspecified - 64.26%/0.26%
[05] |   |   |   |   |   minecraft:furnace - 33.35%/0.14%
[05] |   |   |   |   |   minecraft:chest - 2.39%/0.01%
```
这里是每个部分的简要解释

| [02]                     | tick                  | 99.31%       | 95.81%       |
| :----------------------- | :---------------------- | :----------- | :----------- |
| 该部分的深度             | 该部分的名称           | 它花费的时间与其父部分的百分比。对于层级 0，它是一次刻所花费时间的百分比。对于层级 1，它是其父部分所花费时间的百分比。 | 第二个百分比告诉您它从整个刻中花费了多少时间。

## 对自己的代码进行性能分析

调试性能分析器对 `Entity` 和 `BlockEntity` 有基本支持。如果您想分析其他内容，您可能需要手动创建您的部分，如下所示：
```java
ProfilerFiller#push(yourSectionName : String);
//您想要分析的代码
ProfilerFiller#pop();
```
您可以从 `Level`、`MinecraftServer` 或 `Minecraft` 实例获取 `ProfilerFiller` 实例。现在，您只需要在结果文件中搜索您的部分名称即可。
